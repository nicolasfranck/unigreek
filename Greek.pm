package Greek;
use utf8;
use strict;
use warnings;
use feature qw(:5.10);

our %mapping;
our %end_char = (
  "s" => "ς"
);

sub from_transliteration { 
  my $str = $_[0];
  my(@parts)= $str =~ /(\X)/go;  

  my @output;
  my $current_combination = "";

  my $c = "";
  while(defined($c)){
    $c = shift(@parts);
    while(defined($c) && exists($mapping{ $current_combination.$c })){
      $current_combination.=$c;      
      $c = shift(@parts); 
    }
    if($current_combination ne ""){    

      push @output,($mapping{ $current_combination } || $current_combination);
  
      #last char did not combine with current_combination
      if(defined($c)){        
        $current_combination = $c;
      }else{
        $current_combination = "";
      }
    }elsif(defined($c)){
      push @output,$c;
    }
  }
  my $o = join("",@output);
  $o =~ s/σ$/ς/o;
  $o;
}

%mapping = (
  "a" => "α",
  #one
  "a|" => "ᾳ",
  "a)" => "ἀ",
  "a(" => "ἁ",
  "a\\" => "ὰ",
  "a/" => "ά",
  "a=" => "ᾶ",

  #two (often two or more combinations lead to the same letter)
  "a\\|" => "ᾲ",
  "a|\\" => "ᾲ",

  "a/|" => "ᾴ",
  "a|/" => "ᾴ",

  "a)\\" => "ἂ",
  "a\\)" => "ἂ",

  "a)/" => "ἄ",
  "a/)" => "ἄ",

  "a(\\" => "ἃ",
  "a\\(" => "ἃ",

  "a(/" => "ἅ",
  "a/(" => "ἅ",

  "a)=" => "ἆ",
  "a=)" => "ἆ",

  "a=)" => "ἆ",
  "a)=" => "ἆ",

  "a(=" => "ἇ",
  "a=(" => "ἇ",

  "a|)" => "ᾀ",
  "a)|" => "ᾀ",

  "a(|" => "ᾁ",
  "a|(" => "ᾁ",

  "a=|" => "ᾷ",
  "a|=" => "ᾷ",

  #three
  #ᾂ
  "a)\\|" => "ᾂ",
  "a)|\\" => "ᾂ",
  "a\\|)" => "ᾂ",
  "a\\)|" => "ᾂ",
  "a|)\\" => "ᾂ",
  "a|\\)" => "ᾂ",
  #ᾄ
  "a)/|" => "ᾄ",
  "a)|/" => "ᾄ",
  "a/)|" => "ᾄ",
  "a/|)" => "ᾄ",
  "a|/)" => "ᾄ",
  "a|)/" => "ᾄ",

  #ᾃ
  "a(\\|" => "ᾃ",
  "a(|\\" => "ᾃ",
  "a\\|(" => "ᾃ",
  "a\\(|" => "ᾃ",
  "a|(\\" => "ᾃ",
  "a|\\(" => "ᾃ",
  #ᾅ
  "a(/|" => "ᾅ",
  "a(|/" => "ᾅ",
  "a/(|" => "ᾅ",
  "a/|(" => "ᾅ",
  "a|/(" => "ᾅ",
  "a|(/" => "ᾅ",
  #ᾆ
  "a)=|" => "ᾆ",
  "a)|=" => "ᾆ",
  "a=)|" => "ᾆ",
  "a=|)" => "ᾆ",
  "a|=)" => "ᾆ",
  "a|)=" => "ᾆ",
  #ᾇ
  "a(=|" => "ᾇ",
  "a(|=" => "ᾇ",
  "a=(|" => "ᾇ",
  "a=|(" => "ᾇ",
  "a|=(" => "ᾇ",
  "a|(=" => "ᾇ",

  "b" => "β",
  "g" => "γ",
  "d" => "δ",

  "e" => "ε",
  "e/" => "έ",
  "e\\" => "ὲ",
  "e)" => "ἐ",
  "e(" => "ἑ",

  "e)\\" => "ἒ",
  "e\\)" => "ἒ",

  "e)/" => "ἔ",
  "e/)" => "ἔ",

  "e(\\" => "ἓ",
  "e\\(" => "ἓ",

  "e(/" => "ἕ",  
  "e/(" => "ἕ",  

  "z" => "ζ",

  "h" => "η",
  #one
  "h\\" => "ὴ",
  "h/" => "ή",
  "h)" => "ἠ",
  "h(" => "ἡ",
  "h=" => "ῆ",
  "h|" => "ῃ",

  #two  
  "h)\\" => "ἢ",
  "h)/" => "ἤ",

  "h(\\" => "ἣ",
  "h(/" => "ἥ",

  "h)=" => "ἦ",
  "h=)" => "ἦ",

  "h(=" => "ἧ",
  "h=(" => "ἧ",

  "h|)" => "ᾐ",
  "h)|" => "ᾐ",

  "h(|" => "ᾑ",
  "h|(" => "ᾑ",

  "h=|" => "ῇ",
  "h|=" => "ῇ",

  "h\\|" => "ῂ",
  "h|\\" => "ῂ",

  "h/|" => "ῄ",
  "h|/" => "ῄ",

  #three
  #ᾒ
  "h)\\|" => "ᾒ",
  "h)|\\" => "ᾒ",
  "h\\)|" => "ᾒ",
  "h\\|)" => "ᾒ",
  "h|)\\" => "ᾒ",
  "h|\\)" => "ᾒ",
  #ᾔ
  "h)/|" => "ᾔ",
  "h)|/" => "ᾔ",
  "h/)|" => "ᾔ",
  "h/|)" => "ᾔ",
  "h|/)" => "ᾔ",
  "h|)/" => "ᾔ",
  #ᾓ
  "h(\\|" => "ᾓ",
  "h(|\\" => "ᾓ",
  "h\\(|" => "ᾓ",
  "h\\|(" => "ᾓ",
  "h|\\(" => "ᾓ",
  "h|(\\" => "ᾓ",
  #ᾕ
  "h(/|" => "ᾕ",
  "h(|/" => "ᾕ",
  "h/(|" => "ᾕ",
  "h/|(" => "ᾕ",
  "h|/(" => "ᾕ",
  "h|(/" => "ᾕ",
  #ᾖ
  "h)=|" => "ᾖ",
  "h)|=" => "ᾖ",
  "h=)|" => "ᾖ",
  "h=|)" => "ᾖ",
  "h|=)" => "ᾖ",
  "h|)=" => "ᾖ",
  #ᾗ
  "h(=|" => "ᾗ",
  "h(|=" => "ᾗ",
  "h=(|" => "ᾗ",
  "h=|(" => "ᾗ",
  "h|=(" => "ᾗ",
  "h|(=" => "ᾗ",

  "q" => "θ",

  "i" => "ι",
  #one
  "i\\" => "ὶ",
  "i/" => "ί",
  "i(" => "ἱ",
  "i)" => "ἰ",
  "i=" => "ῖ",
  
  #two
  "i)\\" => "ἲ",
  "i\\)" => "ἲ",

  "i)/" => "ἴ",
  "i/)" => "ἴ",

  "i(\\" => "ἳ",
  "i\\(" => "ἳ",

  "i(/" => "ἵ",
  "i/(" => "ἵ",

  "i)=" => "ἶ",
  "i=)" => "ἶ",

  "i(=" => "ἷ",
  "i=(" => "ἷ",

  "k" => "κ",
  "l" => "λ",
  "m" => "μ",
  "n" => "ν",
  "c" => "ξ",

  "o" => "ο",
  "o\\" => "ὸ",
  "o/" => "ό",
  "o)" => "ὀ",
  "o(" => "ὁ",

  "o)\\" => "ὂ",
  "o\\)" => "ὂ",

  "o)/" => "ὄ",
  "o/)" => "ὄ",

  "o(\\" => "ὃ",
  "o\\(" => "ὃ",

  "o(/" => "ὅ",
  "o/(" => "ὅ",

  "p" => "π",
  "r" => "ρ",
  "s" => "σ",
  #todo: s op einde van een string moet ς  
  "s." => "ς.",
  "s " => "ς ",
  "s," => "ς,",
  "s?" => "ς;",
  "s;" => "ς·",
  "s:" => "ς·",
  
  "t" => "τ",

  "u" => "υ",
  #one
  "u\\" => "ὺ",
  "u/" => "ύ",
  "u)" => "ὐ",
  "u(" => "ὑ",
  "u=" => "ῦ",
  #two
  "u)\\" => "ὒ",
  "u\\)" => "ὒ",

  "u)/" => "ὔ",
  "u/)" => "ὔ",

  "u(\\" => "ὓ",
  "u\\(" => "ὓ",

  "u(/" => "ὕ",
  "u/(" => "ὕ",

  "u)=" => "ὖ",
  "u=)" => "ὖ",

  "u(=" => "ὗ",
  "u=(" => "ὗ",

  "f" => "φ",
  "x" => "χ",
  "y" => "ψ",

  "w" => "ω",
  #one
  "w\\" => "ὼ",
  "w/" => "ώ",
  "w)" => "ὠ",
  "w(" => "ὡ",
  "w=" => "ῶ",
  "w|" => "ῳ",

  #two(TODO: omgekeerde richting)
  "w)\\" => "ὢ",
  "w\\)" => "ὢ",

  "w)/" => "ὤ",
  "w/)" => "ὤ",

  "w(\\" => "ὣ",
  "w\\(" => "ὣ",

  "w(/" => "ὥ",
  "w/(" => "ὥ",

  "w)=" => "ὦ",
  "w=)" => "ὦ",

  "w(=" => "ὧ",
  "w=(" => "ὧ",

  "w\\|" => "ῲ",
  "w|\\" => "ῲ",

  "w/|" => "ῴ",
  "w|/" => "ῴ",

  "w)|" => "ᾠ",
  "w|)" => "ᾠ",

  "w(|" => "ᾡ",
  "w|(" => "ᾡ",

  "w|=" => "ῷ",
  "w=|" => "ῷ",

  #three
  #ᾦ
  "w)=|" => "ᾦ",
  "w)|=" => "ᾦ",
  "w=|)" => "ᾦ",
  "w|=)" => "ᾦ",
  "w=)|" => "ᾦ",
  "w=|)" => "ᾦ",
  #ᾧ
  "w(=|" => "ᾧ",
  "w(|=" => "ᾧ",
  "w=|(" => "ᾧ",
  "w|=(" => "ᾧ",
  "w=(|" => "ᾧ",
  "w=|(" => "ᾧ",

  "v" => "ϝ",  

  "A" => "Α",
  #one
  "A\\" => "Ὰ",
  "A/" => "Ά",
  "A)" => "Ἀ",
  "A(" => "Ἁ",
  "A|" => "ᾼ",

  #two
  "A)\\" => "Ἂ",
  "A\\)" => "Ἂ",

  "A)/" => "Ἄ",
  "A/)" => "Ἄ",

  "A(\\" => "Ἃ",  
  "A\\(" => "Ἃ",  

  "A(/" => "Ἅ",
  "A/(" => "Ἅ",

  "A)=" => "Ἆ",
  "A=)" => "Ἆ",

  "A(=" => "Ἇ",
  "A=(" => "Ἇ",

  "A|)" => "ᾈ",
  "A)|" => "ᾈ",

  "A(|" => "ᾉ",
  "A|(" => "ᾉ",

  #three
  #ᾊ
  "A)\\|" => "ᾊ",
  "A)|\\" => "ᾊ",
  "A\\)|" => "ᾊ",
  "A\\|)" => "ᾊ",
  "A|)\\" => "ᾊ",
  "A|\\)" => "ᾊ",
  #ᾌ
  "A)/|" => "ᾌ",
  "A)|/" => "ᾌ",
  "A/)|" => "ᾌ",
  "A/|)" => "ᾌ",
  "A|)/" => "ᾌ",
  "A|/)" => "ᾌ",
  #ᾋ
  "A(\\|" => "ᾋ",
  "A(|\\" => "ᾋ",
  "A\\(|" => "ᾋ",
  "A\\|(" => "ᾋ",
  "A|\\(" => "ᾋ",
  "A|(\\" => "ᾋ",
  #ᾍ
  "A(/|" => "ᾍ",
  "A(|/" => "ᾍ",
  "A/(|" => "ᾍ",
  "A/|(" => "ᾍ",
  "A|(/" => "ᾍ",
  "A|/(" => "ᾍ",
  #ᾎ
  "A)=|" => "ᾎ",
  "A)|=" => "ᾎ",
  "A=)|" => "ᾎ",
  "A=|)" => "ᾎ",
  "A|=)" => "ᾎ",
  "A|)=" => "ᾎ",

  #ᾏ
  "A(=|" => "ᾏ",
  "A(|=" => "ᾏ",
  "A=(|" => "ᾏ",
  "A=|(" => "ᾏ",
  "A|=(" => "ᾏ",
  "A|(=" => "ᾏ",

  "B" => "Β",
  "G" => "Γ",
  "D" => "Δ",

  "E" => "Ε",
  #one
  "E\\" => "Ὲ",
  "E/" => "Έ",
  "E)" => "Ἐ",
  "E(" => "Ἑ",
  #two
  "E)\\" => "Ἒ",
  "E\\)" => "Ἒ",

  "E)/" => "Ἔ",
  "E/)" => "Ἔ",

  "E(\\" => "Ἓ",
  "E\\(" => "Ἓ",

  "E(/" => "Ἕ",
  "E/(" => "Ἕ",

  "Z" => "Ζ",

  "H" => "Η",
  #one
  "H)" => "Ἠ",
  "H(" => "Ἡ",  
  "H\\" => "Ὴ",
  "H/" => "Ή",
  "H|" => "ῌ",
    #sorry no such thing..
    "H=" => "",
 
  "H)\\" => "Ἢ",
  "H\\)" => "Ἢ",

  "H)/" => "Ἤ",
  "H/)" => "Ἤ",

  "H(\\" => "Ἣ",
  "H\\(" => "Ἣ",

  "H(/" => "Ἥ",
  "H/(" => "Ἥ",

  "H)=" => "Ἦ",
  "H=)" => "Ἦ",

  "H(=" => "Ἧ",
  "H=(" => "Ἧ",

  "H|)" => "ᾘ",
  "H)|" => "ᾘ",

  "H(|" => "ᾙ",
  "H|(" => "ᾙ",    

  #three
  #ᾚ
  "H)\\|" => "ᾚ",
  "H)|\\" => "ᾚ",
  "H\\|)" => "ᾚ",
  "H\\)|" => "ᾚ",
  "H|)\\" => "ᾚ",
  "H|\\)" => "ᾚ",
  #ᾜ
  "H)/|" => "ᾜ",
  "H)|/" => "ᾜ",
  "H/)|" => "ᾜ",
  "H/|)" => "ᾜ",
  "H|)/" => "ᾜ",
  "H|/)" => "ᾜ",
  #ᾛ
  "H(\\|" => "ᾛ",
  "H(|\\" => "ᾛ",
  "H\\(|" => "ᾛ",
  "H\\|(" => "ᾛ",
  "H|\\(" => "ᾛ",
  "H|(\\" => "ᾛ",
  #ᾝ
  "H(/|" => "ᾝ",
  "H(|/" => "ᾝ",
  "H/(|" => "ᾝ",
  "H/|(" => "ᾝ",
  "H|(/" => "ᾝ",
  "H|/(" => "ᾝ",
  #ᾞ
  "H)=|" => "ᾞ",
  "H)|=" => "ᾞ",
  "H=|)" => "ᾞ",
  "H=)|" => "ᾞ",
  "H|=)" => "ᾞ",
  "H|)=" => "ᾞ",

  #ᾟ
  "H(=|" => "ᾟ",
  "H(|=" => "ᾟ",
  "H=(|" => "ᾟ",
  "H=|(" => "ᾟ",
  "H|(=" => "ᾟ",
  "H|=(" => "ᾟ",

  "Q" => "Θ",

  "I" => "Ι",
  #one
  "I\\" => "Ὶ",
  "I/" => "Ί",
  "I)" => "Ἰ",
  "I(" => "Ἱ",
  
  #two
  "I)\\" => "Ἲ",
  "I\\)" => "Ἲ",

  "I)/" => "Ἴ",
  "I/)" => "Ἴ",

  "I(\\" => "Ἳ",
  "I\\(" => "Ἳ",

  "I(/" => "Ἵ",
  "I/(" => "Ἵ",

  "I)=" => "Ἶ",
  "I=)" => "Ἶ",

  "I(=" => "Ἷ",
  "I=(" => "Ἷ",

  "K" => "Κ",
  "L" => "Λ",
  "M" => "Μ",
  "N" => "Ν",
  "C" => "Ξ",

  "O" => "Ο",
  #one  
  "O\\" => "Ὸ",
  "O/" => "Ό",
  "O)" => "Ὀ",
  "O(" => "Ὁ",
  #two
  "O)\\" => "Ὂ",
  "O\\)" => "Ὂ",

  "O)/" => "Ὄ",
  "O/)" => "Ὄ",

  "O(\\" => "Ὃ",
  "O\\(" => "Ὃ",

  "O(/" => "Ὅ",
  "O/(" => "Ὅ",

  "P" => "Π",
  "R" => "Ρ",
  "S" => "Σ",
  "T" => "Τ",

  "U" => "Υ",
  #one  
  "U\\" => "Ὺ",
  "U/" => "aΎ",

  # 'U)' werk niet?
  "U)" => "",

  "U(" => "Ὑ",

  # 'U)' werk niet?
  "U)\\" => "",
  "U)/" => "",

  "U(\\" => "Ὓ",
  "U\\(" => "Ὓ",

  "U(/" => "Ὕ",
  "U/(" => "Ὕ",

  # 'U)' werk niet?
  "U)=" => "",

  "U(=" => "Ὗ",
  "U=(" => "Ὗ",


  "F" => "Φ",
  "X" => "Χ",
  "Y" => "Ψ",

  "W" => "Ω",
  #one
  "W|" => "ῼ",
  "W\\" => "Ὼ",
  "W/" => "Ώ",
  "W)" => "Ὠ",
  "W(" => "Ὡ",
    #sorry
    "W=" => "",

  #two
  "W)\\" => "Ὢ",
  "W\\)" => "Ὢ",

  "W)/" => "Ὤ",
  "W/)" => "Ὤ",

  "W(\\" => "Ὣ",
  "W\\(" => "Ὣ",

  "W(/" => "Ὥ",
  "W/(" => "Ὥ",

  "W)=" => "Ὦ",
  "W=)" => "Ὦ",

  "W(=" => "Ὧ",
  "W=(" => "Ὧ",


  "V" => "Ϝ",
  "," => ",",
  "?" => ";",
  ";" => "·",
  "." => ".",
  ":" => "·",
  "|" => "ͺ"
);

